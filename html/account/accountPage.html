<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="/css/account/accountPage.css" />
        <script src="https://kit.fontawesome.com/610c7ab415.js" crossorigin="anonymous"></script>
        <title>Acount Page</title>
    </head>

    <nav>
        <svg class="close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
            <path id="Icon_material-close" data-name="Icon material-close" d="M28.5,9.615,26.385,7.5,18,15.885,9.615,7.5,7.5,9.615,15.885,18,7.5,26.385,9.615,28.5,18,20.115,26.385,28.5,28.5,26.385,20.115,18Z" transform="translate(-7.5 -7.5)" fill="#ffffff" />
        </svg>

        <ul>
            <li><a href="/html/home/homepage.html">Home Page</a></li>
            <li><a href="#">Edit Profile</a></li>
            <li><a href="#">Your Trainer</a></li>
            <li><a href="#">Payments</a></li>
        </ul>
    </nav>

    <svg class="menu" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">
        <g id="Icon_feather-sidebar" data-name="Icon feather-sidebar" transform="translate(-3 -3)">
            <path id="Path_1" data-name="Path 1" d="M7.5,4.5h21a3,3,0,0,1,3,3v21a3,3,0,0,1-3,3H7.5a3,3,0,0,1-3-3V7.5a3,3,0,0,1,3-3Z" fill="none" stroke="#f5989d" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" />
            <path id="Path_2" data-name="Path 2" d="M13.5,4.5v27" fill="none" stroke="#f5989d" stroke-linecap="round" stroke-linejoin="round" stroke-width="3" />
        </g>
    </svg>

    <script>
        const menu = document.querySelector(".menu");
        const close = document.querySelector(".close");
        const nav = document.querySelector("nav");

        menu.addEventListener("click", () => {
            nav.classList.add("open-nav");
        });

        close.addEventListener("click", () => {
            nav.classList.remove("open-nav");
        });
    </script>

    <!-- 
    Profile Picture Default SVG File
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 34.875 34.875">
        <path id="Icon_awesome-user-circle" data-name="Icon awesome-user-circle" d="M17.438.563A17.438,17.438,0,1,0,34.875,18,17.434,17.434,0,0,0,17.438.563Zm0,6.75A6.188,6.188,0,1,1,11.25,13.5,6.188,6.188,0,0,1,17.438,7.313Zm0,24.188a13.474,13.474,0,0,1-10.3-4.8,7.839,7.839,0,0,1,6.926-4.2,1.72,1.72,0,0,1,.5.077,9.309,9.309,0,0,0,2.876.485,9.274,9.274,0,0,0,2.876-.485,1.72,1.72,0,0,1,.5-.077,7.839,7.839,0,0,1,6.926,4.2A13.474,13.474,0,0,1,17.438,31.5Z" transform="translate(0 -0.563)"/>
    </svg> 
    -->

    <body class="account-page">
        <div class="about" id="app">
            <div class="box-account">
                <div class="top-account">
                    <img class="cropped1" src="/images/hayley-kim.jpg" alt="hayley-kim-pic" />
                    <h2>{{ name }}</h2>
                </div>

                <div class="middle-account">
                    <div class="info-columns-1">
                        <h4>Age:</h4>
                        <h4>Gender:</h4>
                        <h4>Height:</h4>
                        <h4>Weight:</h4>
                    </div>

                    <div class="info-columns-2">
                        <h4>{{ age }}</h4>
                        <h4>{{ gender }}</h4>
                        <h4>{{ height }}</h4>
                        <h4>{{ weight }}</h4>
                    </div>
                </div>

                <div class="bottom-account">
                    <p>{{ description }}</p>
                </div>
            </div>
        </div>

        <script src="/js/vue.js" type="text/javascript" charset="utf-8"></script>
        <script src="/js/jquery.js" charset="utf-8"></script>
        <script>
            var app = new Vue({
                el: '#app',
                data: {
                    name: '',
                    age: '',
                    gender: '',
                    height: '',
                    weight: '',
                    description: 'Please edit your description in the Edit Profile page using the menu button.'
                },
                created: function() {
                    this.initPerMsg();
                },
                mounted: function() {},
                methods: {
                    initPerMsg() {
                        $.ajax({
                            type: "GET",
                            url: "http://127.0.0.1:8000/api/users/profile/",
                            data: "",
                            headers: {
                                Authorization: "Bearer " + localStorage.getItem("token")
                            },

                            success: function(rs) {
                                if (rs != null) {
                                    this.name = rs.name;
                                    this.gender = rs.user_profile.gender;
                                    this.weight = rs.user_profile.weight + "LB";
                                    
                                    // Get Height
                                    var feet = rs.user_profile.height / 12;
                                    var inch = rs.user_profile.height % 12;
                                    this.height = feet + "\'" + inch + "\"";

                                    // Get Description
                                    if(rs.user_profile.description != null) {
                                        this.description = rs.user_profile.description;
                                    }

                                    // Get Age
                                    var dob = rs.user_profile.dob;
                                    var today = new Date();
                                    var yearDiff = today.getFullYear - parseInt(dob.substring(0,4));
                                    var monthDiff = today.getMonth - parseInt(dob.substring(5, 7));
                                    if (monthDiff < 0 || (monthDiff == 0 && today.getDate() < parseInt(dob.substring(8)))) {
                                        yearDiff = yearDiff - 1;
                                    }
                                    this.age = yearDiff;

                                }
                                else {
                                    alert("Error Loading Information!");
                                }
                            }
                        })
                    }
                }
            })
        </script>
    </body>
</html>
